## 가능한 한 실패 원자적으로 만들라

### 실패 원자성(Failure Atomicity)
- 호출된 메소드가 실패하더라도 해당 객체는 메소드 호출 전 상태를 유지하게 하는 것
- 작업 도중 예외가 발생해도 그 객채는 여전히 정상적으로 사용할 수 있는 상태

> 가능한 한 실패 원자적으로 만들자

#
### 방법 1. 불변 객체로 설계하기
- 불변 객체는 태생적으로 실패 원자적이다

#
### 방법 2. 작업 수행 전 매개변수의 유효성 검사하기
- 내부 상태 변경 전에 잠재적 예외의 가능성 대부분을 걸러낼 수 있는 방법
- 비슷한 방법으로 실패할 가능성이 있는 코드를 객체의 상태 변경 전 모두 수행하는 방법도 있음
  
```java
public Object pop() {
   if (size == 0)
      throw new EmptyStackException();
   Object result = elements[--size];
   elements[size] = null; // 다 쓴 참조 해제
   return result;
}
```

#
### 방법 3. 임시 복사본 객체 사용
- 객체의 임시 복사본에서 작업을 수행하고 작업이 성공적으로 완료되면 원래 객체와 교체
- 데이터를 임시 자료구조에 저장해 작업하는게 더 빠를 때 적용하면 좋은 방식
- 리스트 정렬할 때 임시 배열에 복사하는 상황에도 실패 원자성 충족

#
### 방법 4. 복구 코드 작성
- 작업도중 발생하는 실패를 가로채는 복구 코드를 작성해 상태를 되돌리기
- 주로 디스티 기반의 내구성을 보장해야하는 자료구조에 사용 (자주 사용하는 방식은 아님)
