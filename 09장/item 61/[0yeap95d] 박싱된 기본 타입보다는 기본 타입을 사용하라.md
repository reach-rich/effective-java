### 📝 자바의 데이터타입

1. `int`, `double`, `boolean` 같은 기본타입
2. `String`, `List` 같은 참조 타입 / `Integer`, `Double`, `Boolean` 같은 기본 타입에 대응하는 참조 타입

<br>

### ⚔ 기본 타입과 박싱된 기본 타입의 차이점

1. 기본 타입은 값만 가지고 있으나, 박싱된 기본 타입은 값에 더해 식별성(identity)이란 속성을 가짐
   - 박싱된 기본 타입은 두 인스턴스는 값이 같더라도 서로 다르다고 식별될 수 있음
2. 기본 타입의 값은 언제나 유효하나, 박싱된 기본 타입은 유효하지 않은 값, 즉 `null`을 가질 수 있음
3. 기본 타입이 박싱된 기본 타입보다 시간과 메모리 사용면에서 더 효율적임

<br>

### 🔎 차이점으로 인해 발생할 수 있는 문제들

**✏ #01 예제소스 | Integer 값을 오름차순 정렬하는 잘못 구현된 비교자**

```java
Comparator<Integer> naturalOrder = 
    (i, j) -> (i < j) ? -1 : (i == j ? 0 : 1);
```

>**문제점**
>: `naturalOrder.compare(new Integer(42), new Integer(42))` 값 출력 시 두 인스턴스의 값이 `42`로 같으므로 `0`이 나와야하지만, 실제로는 `1`을 출력한다
>
>**원인**
>: `(i == j)` 에서 같은 값을 가진 두 인스턴스라도 '객체 참조'의 식별성을 검사하므로 결과는 `false`가 나오고 `1`을 반환한다

**✔ 박싱된 기본 타입에 == 연산자를 사용하면 오류가 일어난다!**

<br>

**✏ #02 예제소스 | 문제를 수정한 비교자**

```java
Comparator<Integer> naturalOrder = (iBoxed, jBoxed) -> {
    int i = iBoxed, j = jBoxed;	// 오토박싱
    return i < j ? -1 : (i == j ? 0 : 1);
}
```

<br>

**✏ #03 예제소스 | 기이하게 동작하는 프로그램**

```java
public class Unbelievable {
    static Integer i;
    
    public static void main(String[] args) {
        if (i == 42)
            System.out.println("믿을 수 없군!");
    }
}
```

>**문제점**
>: 이 프로그램은 `"믿을 수 없군!"` 을 출력하지만, `i == 42`를 검사할 때 `NullPointerException`을 던짐
>
>**원인**
>: `i`가 `int`가 아닌 `Integer`이며, 다른 참조 타입 필드와 마찬가지로 `i`의 초깃값도 `null`이므로, `i == 42`는 `Integer`와 `int`를 비교하는 것
>
>**해결방법**
>: `i`를 `int`로 선언해주면 됨

**✔ 기본 타입과 박싱된 기본 타입을 혼용한 연산에서는 박싱된 기본 타입의 박싱이 자동으로 풀린다**

<br>

**✏ #04 예제소스 | 끔직히 느리다! 객체가 만들어지는 위치를 찾았는가?**

```java
public static void main(String[] args) {
    Long sum = 0l;
    for (long i = 0; i <= Integer.MAX_VALUE; i++) {
        sum += i;
    }
    System.out.println(sum);
}
```

> 이 프로그램은 실수로 지역변수 `sum`을 박싱된 기본 타입으로 선언하여 느려졌음
>
> 오류나 경고 없이 컴파일되지만, 박싱과 언박싱이 반복해서 일어나 체감될 정도로 성능 저하

<br>

### ❓ 박싱된 타입은 언제 써야하는가

1. 컬렉션의 원소, 키, 값으로 사용 
   - 컬렌션은 기본 타입을 담을 수 없으므로 박싱된 기본 타입을 사용해야함
2. 리플렉션을 통해 메서드를 호출할 때

<br>

### 📌 핵심정리

**기본 타입과 박싱된 기본 타입 중 하나를 사용해야한다면 기본 타입을 사용하라**

**오토박싱이 박싱된 기본 타입을 사용할 때의 번거로움을 줄여주지만, 그 위험까지 없애주지는 않는다**

<br>

